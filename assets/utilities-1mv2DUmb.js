(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))s(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const r of o.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&s(r)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();var m=function(n,e,t,s){function i(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function d(u){try{a(s.next(u))}catch(c){r(c)}}function h(u){try{a(s.throw(u))}catch(c){r(c)}}function a(u){u.done?o(u.value):i(u.value).then(d,h)}a((s=s.apply(n,e||[])).next())})};class ot{constructor(e){this.messageBus=e}get id(){if(!this.messageBus.userId)throw Error("Unable to get user ID: not ready");return this.messageBus.userId}getSelection(){return m(this,void 0,void 0,function*(){const{selection:e}=yield this.messageBus.sendAsync("OBR_PLAYER_GET_SELECTION",{});return e})}select(e,t){return m(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_PLAYER_SELECT",{items:e,replace:t})})}deselect(e){return m(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_PLAYER_DESELECT",{items:e})})}getName(){return m(this,void 0,void 0,function*(){const{name:e}=yield this.messageBus.sendAsync("OBR_PLAYER_GET_NAME",{});return e})}setName(e){return m(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_PLAYER_SET_NAME",{name:e})})}getColor(){return m(this,void 0,void 0,function*(){const{color:e}=yield this.messageBus.sendAsync("OBR_PLAYER_GET_COLOR",{});return e})}setColor(e){return m(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_PLAYER_SET_COLOR",{color:e})})}getSyncView(){return m(this,void 0,void 0,function*(){const{syncView:e}=yield this.messageBus.sendAsync("OBR_PLAYER_GET_SYNC_VIEW",{});return e})}setSyncView(e){return m(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_PLAYER_SET_SYNC_VIEW",{syncView:e})})}getId(){return m(this,void 0,void 0,function*(){const{id:e}=yield this.messageBus.sendAsync("OBR_PLAYER_GET_ID",{});return e})}getRole(){return m(this,void 0,void 0,function*(){const{role:e}=yield this.messageBus.sendAsync("OBR_PLAYER_GET_ROLE",{});return e})}getMetadata(){return m(this,void 0,void 0,function*(){const{metadata:e}=yield this.messageBus.sendAsync("OBR_PLAYER_GET_METADATA",{});return e})}setMetadata(e){return m(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_PLAYER_SET_METADATA",{update:e})})}hasPermission(e){return m(this,void 0,void 0,function*(){if((yield this.getRole())==="GM")return!0;const{permissions:s}=yield this.messageBus.sendAsync("OBR_ROOM_GET_PERMISSIONS",{});return s.indexOf(e)>-1})}getConnectionId(){return m(this,void 0,void 0,function*(){const{connectionId:e}=yield this.messageBus.sendAsync("OBR_PLAYER_GET_CONNECTION_ID",{});return e})}onChange(e){const t=s=>{e(s.player)};return this.messageBus.send("OBR_PLAYER_SUBSCRIBE",{}),this.messageBus.on("OBR_PLAYER_EVENT_CHANGE",t),()=>{this.messageBus.send("OBR_PLAYER_UNSUBSCRIBE",{}),this.messageBus.off("OBR_PLAYER_EVENT_CHANGE",t)}}}var I=function(n,e,t,s){function i(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function d(u){try{a(s.next(u))}catch(c){r(c)}}function h(u){try{a(s.throw(u))}catch(c){r(c)}}function a(u){u.done?o(u.value):i(u.value).then(d,h)}a((s=s.apply(n,e||[])).next())})};class rt{constructor(e){this.messageBus=e}reset(){return I(this,void 0,void 0,function*(){const{transform:e}=yield this.messageBus.sendAsync("OBR_VIEWPORT_RESET",{});return e})}animateTo(e){return I(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_VIEWPORT_ANIMATE_TO",{transform:e})})}animateToBounds(e){return I(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_VIEWPORT_ANIMATE_TO_BOUNDS",{bounds:e})})}getPosition(){return I(this,void 0,void 0,function*(){const{position:e}=yield this.messageBus.sendAsync("OBR_VIEWPORT_GET_POSITION",{});return e})}setPosition(e){return I(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_VIEWPORT_SET_POSITION",{position:e})})}getScale(){return I(this,void 0,void 0,function*(){const{scale:e}=yield this.messageBus.sendAsync("OBR_VIEWPORT_GET_SCALE",{});return e})}setScale(e){return I(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_VIEWPORT_SET_SCALE",{scale:e})})}getWidth(){return I(this,void 0,void 0,function*(){const{width:e}=yield this.messageBus.sendAsync("OBR_VIEWPORT_GET_WIDTH",{});return e})}getHeight(){return I(this,void 0,void 0,function*(){const{height:e}=yield this.messageBus.sendAsync("OBR_VIEWPORT_GET_HEIGHT",{});return e})}transformPoint(e){return I(this,void 0,void 0,function*(){const{point:t}=yield this.messageBus.sendAsync("OBR_VIEWPORT_TRANSFORM_POINT",{point:e});return t})}inverseTransformPoint(e){return I(this,void 0,void 0,function*(){const{point:t}=yield this.messageBus.sendAsync("OBR_VIEWPORT_INVERSE_TRANSFORM_POINT",{point:e});return t})}}function ut(n){return typeof n.id=="string"}var Oe={exports:{}},H=typeof Reflect=="object"?Reflect:null,Ne=H&&typeof H.apply=="function"?H.apply:function(e,t,s){return Function.prototype.apply.call(e,t,s)},q;H&&typeof H.ownKeys=="function"?q=H.ownKeys:Object.getOwnPropertySymbols?q=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:q=function(e){return Object.getOwnPropertyNames(e)};function at(n){console&&console.warn&&console.warn(n)}var $e=Number.isNaN||function(e){return e!==e};function f(){f.init.call(this)}Oe.exports=f;Oe.exports.once=lt;f.EventEmitter=f;f.prototype._events=void 0;f.prototype._eventsCount=0;f.prototype._maxListeners=void 0;var we=10;function ne(n){if(typeof n!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof n)}Object.defineProperty(f,"defaultMaxListeners",{enumerable:!0,get:function(){return we},set:function(n){if(typeof n!="number"||n<0||$e(n))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+n+".");we=n}});f.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};f.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||$e(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function Ke(n){return n._maxListeners===void 0?f.defaultMaxListeners:n._maxListeners}f.prototype.getMaxListeners=function(){return Ke(this)};f.prototype.emit=function(e){for(var t=[],s=1;s<arguments.length;s++)t.push(arguments[s]);var i=e==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var r;if(t.length>0&&(r=t[0]),r instanceof Error)throw r;var d=new Error("Unhandled error."+(r?" ("+r.message+")":""));throw d.context=r,d}var h=o[e];if(h===void 0)return!1;if(typeof h=="function")Ne(h,this,t);else for(var a=h.length,u=Qe(h,a),s=0;s<a;++s)Ne(u[s],this,t);return!0};function ze(n,e,t,s){var i,o,r;if(ne(t),o=n._events,o===void 0?(o=n._events=Object.create(null),n._eventsCount=0):(o.newListener!==void 0&&(n.emit("newListener",e,t.listener?t.listener:t),o=n._events),r=o[e]),r===void 0)r=o[e]=t,++n._eventsCount;else if(typeof r=="function"?r=o[e]=s?[t,r]:[r,t]:s?r.unshift(t):r.push(t),i=Ke(n),i>0&&r.length>i&&!r.warned){r.warned=!0;var d=new Error("Possible EventEmitter memory leak detected. "+r.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");d.name="MaxListenersExceededWarning",d.emitter=n,d.type=e,d.count=r.length,at(d)}return n}f.prototype.addListener=function(e,t){return ze(this,e,t,!1)};f.prototype.on=f.prototype.addListener;f.prototype.prependListener=function(e,t){return ze(this,e,t,!0)};function ct(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Xe(n,e,t){var s={fired:!1,wrapFn:void 0,target:n,type:e,listener:t},i=ct.bind(s);return i.listener=t,s.wrapFn=i,i}f.prototype.once=function(e,t){return ne(t),this.on(e,Xe(this,e,t)),this};f.prototype.prependOnceListener=function(e,t){return ne(t),this.prependListener(e,Xe(this,e,t)),this};f.prototype.removeListener=function(e,t){var s,i,o,r,d;if(ne(t),i=this._events,i===void 0)return this;if(s=i[e],s===void 0)return this;if(s===t||s.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,s.listener||t));else if(typeof s!="function"){for(o=-1,r=s.length-1;r>=0;r--)if(s[r]===t||s[r].listener===t){d=s[r].listener,o=r;break}if(o<0)return this;o===0?s.shift():dt(s,o),s.length===1&&(i[e]=s[0]),i.removeListener!==void 0&&this.emit("removeListener",e,d||t)}return this};f.prototype.off=f.prototype.removeListener;f.prototype.removeAllListeners=function(e){var t,s,i;if(s=this._events,s===void 0)return this;if(s.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):s[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete s[e]),this;if(arguments.length===0){var o=Object.keys(s),r;for(i=0;i<o.length;++i)r=o[i],r!=="removeListener"&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=s[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function Ze(n,e,t){var s=n._events;if(s===void 0)return[];var i=s[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?ht(i):Qe(i,i.length)}f.prototype.listeners=function(e){return Ze(this,e,!0)};f.prototype.rawListeners=function(e){return Ze(this,e,!1)};f.listenerCount=function(n,e){return typeof n.listenerCount=="function"?n.listenerCount(e):qe.call(n,e)};f.prototype.listenerCount=qe;function qe(n){var e=this._events;if(e!==void 0){var t=e[n];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}f.prototype.eventNames=function(){return this._eventsCount>0?q(this._events):[]};function Qe(n,e){for(var t=new Array(e),s=0;s<e;++s)t[s]=n[s];return t}function dt(n,e){for(;e+1<n.length;e++)n[e]=n[e+1];n.pop()}function ht(n){for(var e=new Array(n.length),t=0;t<e.length;++t)e[t]=n[t].listener||n[t];return e}function lt(n,e){return new Promise(function(t,s){function i(r){n.removeListener(e,o),s(r)}function o(){typeof n.removeListener=="function"&&n.removeListener("error",i),t([].slice.call(arguments))}Je(n,e,o,{once:!0}),e!=="error"&&ft(n,i,{once:!0})})}function ft(n,e,t){typeof n.on=="function"&&Je(n,"error",e,t)}function Je(n,e,t,s){if(typeof n.on=="function")s.once?n.once(e,t):n.on(e,t);else if(typeof n.addEventListener=="function")n.addEventListener(e,function i(o){s.once&&n.removeEventListener(e,i),t(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof n)}var _t=Oe.exports;let z;const Et=new Uint8Array(16);function yt(){if(!z&&(z=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!z))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return z(Et)}const O=[];for(let n=0;n<256;++n)O.push((n+256).toString(16).slice(1));function Ot(n,e=0){return O[n[e+0]]+O[n[e+1]]+O[n[e+2]]+O[n[e+3]]+"-"+O[n[e+4]]+O[n[e+5]]+"-"+O[n[e+6]]+O[n[e+7]]+"-"+O[n[e+8]]+O[n[e+9]]+"-"+O[n[e+10]]+O[n[e+11]]+O[n[e+12]]+O[n[e+13]]+O[n[e+14]]+O[n[e+15]]}const pt=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Me={randomUUID:pt};function vt(n,e,t){if(Me.randomUUID&&!e&&!n)return Me.randomUUID();n=n||{};const s=n.random||(n.rng||yt)();if(s[6]=s[6]&15|64,s[8]=s[8]&63|128,e){t=t||0;for(let i=0;i<16;++i)e[t+i]=s[i];return e}return Ot(s)}class mt extends _t.EventEmitter{constructor(e,t){super(),this.ready=!1,this.userId=null,this.ref=null,this.handleMessage=s=>{const i=s.data;if(s.origin===this.targetOrigin&&ut(i)){if(i.id==="OBR_READY"){this.ready=!0;const o=i.data;this.ref=o.ref,this.userId=o.userId}this.emit(i.id,i.data)}},this.send=(s,i,o)=>{var r;if(!this.ref)throw Error("Unable to send message: not ready");(r=window.parent)===null||r===void 0||r.postMessage({id:s,data:i,ref:this.ref,nonce:o},this.targetOrigin)},this.sendAsync=(s,i,o=5e3)=>{const r=`_${vt()}`;return this.send(s,i,r),Promise.race([new Promise((d,h)=>{const a=this;function u(_){a.off(`${s}_RESPONSE${r}`,u),a.off(`${s}_ERROR${r}`,c),d(_)}function c(_){a.off(`${s}_RESPONSE${r}`,u),a.off(`${s}_ERROR${r}`,c),h(_)}this.on(`${s}_RESPONSE${r}`,u),this.on(`${s}_ERROR${r}`,c)}),new Promise((d,h)=>window.setTimeout(()=>h(new Error(`Message ${s} took longer than ${o}ms to get a result`)),o))])},this.roomId=t,this.targetOrigin=e,window.addEventListener("message",this.handleMessage),this.setMaxListeners(100)}destroy(){window.removeEventListener("message",this.handleMessage)}}var Le=function(n,e,t,s){function i(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function d(u){try{a(s.next(u))}catch(c){r(c)}}function h(u){try{a(s.throw(u))}catch(c){r(c)}}function a(u){u.done?o(u.value):i(u.value).then(d,h)}a((s=s.apply(n,e||[])).next())})};class Tt{constructor(e){this.messageBus=e}show(e,t){return Le(this,void 0,void 0,function*(){const{id:s}=yield this.messageBus.sendAsync("OBR_NOTIFICATION_SHOW",{message:e,variant:t});return s})}close(e){return Le(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_NOTIFICATION_CLOSE",{id:e})})}}var G=function(n,e,t,s){function i(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function d(u){try{a(s.next(u))}catch(c){r(c)}}function h(u){try{a(s.throw(u))}catch(c){r(c)}}function a(u){u.done?o(u.value):i(u.value).then(d,h)}a((s=s.apply(n,e||[])).next())})};class At{constructor(e){this.messageBus=e}getColor(){return G(this,void 0,void 0,function*(){const{color:e}=yield this.messageBus.sendAsync("OBR_SCENE_FOG_GET_COLOR",{});return e})}setColor(e){return G(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_SCENE_FOG_SET_COLOR",{color:e})})}getStrokeWidth(){return G(this,void 0,void 0,function*(){const{strokeWidth:e}=yield this.messageBus.sendAsync("OBR_SCENE_FOG_GET_STROKE_WIDTH",{});return e})}setStrokeWidth(e){return G(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_SCENE_FOG_SET_STROKE_WIDTH",{strokeWidth:e})})}getFilled(){return G(this,void 0,void 0,function*(){const{filled:e}=yield this.messageBus.sendAsync("OBR_SCENE_FOG_GET_FILLED",{});return e})}setFilled(e){return G(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_SCENE_FOG_SET_FILLED",{filled:e})})}onChange(e){const t=s=>{e(s.fog)};return this.messageBus.send("OBR_SCENE_FOG_SUBSCRIBE",{}),this.messageBus.on("OBR_SCENE_FOG_EVENT_CHANGE",t),()=>{this.messageBus.send("OBR_SCENE_FOG_UNSUBSCRIBE",{}),this.messageBus.off("OBR_SCENE_FOG_EVENT_CHANGE",t)}}}var T=function(n,e,t,s){function i(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function d(u){try{a(s.next(u))}catch(c){r(c)}}function h(u){try{a(s.throw(u))}catch(c){r(c)}}function a(u){u.done?o(u.value):i(u.value).then(d,h)}a((s=s.apply(n,e||[])).next())})};class gt{constructor(e){this.messageBus=e}getDpi(){return T(this,void 0,void 0,function*(){const{dpi:e}=yield this.messageBus.sendAsync("OBR_SCENE_GRID_GET_DPI",{});return e})}getScale(){return T(this,void 0,void 0,function*(){return yield this.messageBus.sendAsync("OBR_SCENE_GRID_GET_SCALE",{})})}setScale(e){return T(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_SCENE_GRID_SET_SCALE",{scale:e})})}getColor(){return T(this,void 0,void 0,function*(){const{color:e}=yield this.messageBus.sendAsync("OBR_SCENE_GRID_GET_COLOR",{});return e})}setColor(e){return T(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_SCENE_GRID_SET_COLOR",{color:e})})}getOpacity(){return T(this,void 0,void 0,function*(){const{opacity:e}=yield this.messageBus.sendAsync("OBR_SCENE_GRID_GET_OPACITY",{});return e})}setOpacity(e){return T(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_SCENE_GRID_SET_OPACITY",{opacity:e})})}getType(){return T(this,void 0,void 0,function*(){const{type:e}=yield this.messageBus.sendAsync("OBR_SCENE_GRID_GET_TYPE",{});return e})}setType(e){return T(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_SCENE_GRID_SET_TYPE",{type:e})})}getLineType(){return T(this,void 0,void 0,function*(){const{lineType:e}=yield this.messageBus.sendAsync("OBR_SCENE_GRID_GET_LINE_TYPE",{});return e})}setLineType(e){return T(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_SCENE_GRID_SET_LINE_TYPE",{lineType:e})})}getMeasurement(){return T(this,void 0,void 0,function*(){const{measurement:e}=yield this.messageBus.sendAsync("OBR_SCENE_GRID_GET_MEASUREMENT",{});return e})}setMeasurement(e){return T(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_SCENE_GRID_SET_MEASUREMENT",{measurement:e})})}snapPosition(e,t,s,i){return T(this,void 0,void 0,function*(){const{position:o}=yield this.messageBus.sendAsync("OBR_SCENE_GRID_SNAP_POSITION",{position:e,snappingSensitivity:t,useCorners:s,useCenter:i});return o})}getDistance(e,t){return T(this,void 0,void 0,function*(){const{distance:s}=yield this.messageBus.sendAsync("OBR_SCENE_GRID_GET_DISTANCE",{from:e,to:t});return s})}onChange(e){const t=s=>{e(s.grid)};return this.messageBus.send("OBR_SCENE_GRID_SUBSCRIBE",{}),this.messageBus.on("OBR_SCENE_GRID_EVENT_CHANGE",t),()=>{this.messageBus.send("OBR_SCENE_GRID_UNSUBSCRIBE",{}),this.messageBus.off("OBR_SCENE_GRID_EVENT_CHANGE",t)}}}var X=function(n,e,t,s){function i(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function d(u){try{a(s.next(u))}catch(c){r(c)}}function h(u){try{a(s.throw(u))}catch(c){r(c)}}function a(u){u.done?o(u.value):i(u.value).then(d,h)}a((s=s.apply(n,e||[])).next())})};class Bt{constructor(e){this.messageBus=e}undo(){return X(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_SCENE_HISTORY_UNDO",{})})}redo(){return X(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_SCENE_HISTORY_REDO",{})})}canUndo(){return X(this,void 0,void 0,function*(){const{canUndo:e}=yield this.messageBus.sendAsync("OBR_SCENE_HISTORY_CAN_UNDO",{});return e})}canRedo(){return X(this,void 0,void 0,function*(){const{canRedo:e}=yield this.messageBus.sendAsync("OBR_SCENE_HISTORY_CAN_REDO",{});return e})}}function v(n){for(var e=arguments.length,t=Array(e>1?e-1:0),s=1;s<e;s++)t[s-1]=arguments[s];throw Error("[Immer] minified error nr: "+n+(t.length?" "+t.map(function(i){return"'"+i+"'"}).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function D(n){return!!n&&!!n[C]}function M(n){var e;return!!n&&(function(t){if(!t||typeof t!="object")return!1;var s=Object.getPrototypeOf(t);if(s===null)return!0;var i=Object.hasOwnProperty.call(s,"constructor")&&s.constructor;return i===Object||typeof i=="function"&&Function.toString.call(i)===Lt}(n)||Array.isArray(n)||!!n[W]||!!(!((e=n.constructor)===null||e===void 0)&&e[W])||se(n)||ie(n))}function j(n,e,t){t===void 0&&(t=!1),L(n)===0?(t?Object.keys:Be)(n).forEach(function(s){t&&typeof s=="symbol"||e(s,n[s],n)}):n.forEach(function(s,i){return e(i,s,n)})}function L(n){var e=n[C];return e?e.i>3?e.i-4:e.i:Array.isArray(n)?1:se(n)?2:ie(n)?3:0}function $(n,e){return L(n)===2?n.has(e):Object.prototype.hasOwnProperty.call(n,e)}function Q(n,e){return L(n)===2?n.get(e):n[e]}function et(n,e,t){var s=L(n);s===2?n.set(e,t):s===3?n.add(t):n[e]=t}function Rt(n,e){return n===e?n!==0||1/n==1/e:n!=n&&e!=e}function se(n){return wt&&n instanceof Map}function ie(n){return Mt&&n instanceof Set}function x(n){return n.o||n.t}function pe(n){if(Array.isArray(n))return Array.prototype.slice.call(n);var e=xt(n);delete e[C];for(var t=Be(e),s=0;s<t.length;s++){var i=t[s],o=e[i];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(e[i]={configurable:!0,writable:!0,enumerable:o.enumerable,value:n[i]})}return Object.create(Object.getPrototypeOf(n),e)}function ve(n,e){return e===void 0&&(e=!1),me(n)||D(n)||!M(n)||(L(n)>1&&(n.set=n.add=n.clear=n.delete=Ct),Object.freeze(n),e&&j(n,function(t,s){return ve(s,!0)},!0)),n}function Ct(){v(2)}function me(n){return n==null||typeof n!="object"||Object.isFrozen(n)}function w(n){var e=_e[n];return e||v(18,n),e}function St(n,e){_e[n]||(_e[n]=e)}function xe(){return K}function oe(n,e){e&&(w("Patches"),n.u=[],n.s=[],n.v=e)}function J(n){he(n),n.p.forEach(It),n.p=null}function he(n){n===K&&(K=n.l)}function be(n){return K={p:[],l:K,h:n,m:!0,_:0}}function It(n){var e=n[C];e.i===0||e.i===1?e.j():e.g=!0}function re(n,e){e._=e.p.length;var t=e.p[0],s=n!==void 0&&n!==t;return e.h.O||w("ES5").S(e,n,s),s?(t[C].P&&(J(e),v(4)),M(n)&&(n=ee(e,n),e.l||te(e,n)),e.u&&w("Patches").M(t[C].t,n,e.u,e.s)):n=ee(e,t,[]),J(e),e.u&&e.v(e.u,e.s),n!==ge?n:void 0}function ee(n,e,t){if(me(e))return e;var s=e[C];if(!s)return j(e,function(d,h){return De(n,s,e,d,h,t)},!0),e;if(s.A!==n)return e;if(!s.P)return te(n,s.t,!0),s.t;if(!s.I){s.I=!0,s.A._--;var i=s.i===4||s.i===5?s.o=pe(s.k):s.o,o=i,r=!1;s.i===3&&(o=new Set(i),i.clear(),r=!0),j(o,function(d,h){return De(n,s,i,d,h,t,r)}),te(n,i,!1),t&&n.u&&w("Patches").N(s,t,n.u,n.s)}return s.o}function De(n,e,t,s,i,o,r){if(D(i)){var d=ee(n,i,o&&e&&e.i!==3&&!$(e.R,s)?o.concat(s):void 0);if(et(t,s,d),!D(d))return;n.m=!1}else r&&t.add(i);if(M(i)&&!me(i)){if(!n.h.D&&n._<1)return;ee(n,i),e&&e.A.l||te(n,i)}}function te(n,e,t){t===void 0&&(t=!1),!n.l&&n.h.D&&n.m&&ve(e,t)}function ue(n,e){var t=n[C];return(t?x(t):n)[e]}function Pe(n,e){if(e in n)for(var t=Object.getPrototypeOf(n);t;){var s=Object.getOwnPropertyDescriptor(t,e);if(s)return s;t=Object.getPrototypeOf(t)}}function le(n){n.P||(n.P=!0,n.l&&le(n.l))}function ae(n){n.o||(n.o=pe(n.t))}function fe(n,e,t){var s=se(e)?w("MapSet").F(e,t):ie(e)?w("MapSet").T(e,t):n.O?function(i,o){var r=Array.isArray(i),d={i:r?1:0,A:o?o.A:xe(),P:!1,I:!1,R:{},l:o,t:i,k:null,o:null,j:null,C:!1},h=d,a=Ee;r&&(h=[d],a=Y);var u=Proxy.revocable(h,a),c=u.revoke,_=u.proxy;return d.k=_,d.j=c,_}(e,t):w("ES5").J(e,t);return(t?t.A:xe()).p.push(s),s}function Nt(n){return D(n)||v(22,n),function e(t){if(!M(t))return t;var s,i=t[C],o=L(t);if(i){if(!i.P&&(i.i<4||!w("ES5").K(i)))return i.t;i.I=!0,s=Ge(t,o),i.I=!1}else s=Ge(t,o);return j(s,function(r,d){i&&Q(i.t,r)===d||et(s,r,e(d))}),o===3?new Set(s):s}(n)}function Ge(n,e){switch(e){case 2:return new Map(n);case 3:return Array.from(n)}return pe(n)}function Te(){function n(s){if(!M(s))return s;if(Array.isArray(s))return s.map(n);if(se(s))return new Map(Array.from(s.entries()).map(function(r){return[r[0],n(r[1])]}));if(ie(s))return new Set(Array.from(s).map(n));var i=Object.create(Object.getPrototypeOf(s));for(var o in s)i[o]=n(s[o]);return $(s,W)&&(i[W]=s[W]),i}function e(s){return D(s)?n(s):s}var t="add";St("Patches",{$:function(s,i){return i.forEach(function(o){for(var r=o.path,d=o.op,h=s,a=0;a<r.length-1;a++){var u=L(h),c=r[a];typeof c!="string"&&typeof c!="number"&&(c=""+c),u!==0&&u!==1||c!=="__proto__"&&c!=="constructor"||v(24),typeof h=="function"&&c==="prototype"&&v(24),typeof(h=Q(h,c))!="object"&&v(15,r.join("/"))}var _=L(h),l=n(o.value),E=r[r.length-1];switch(d){case"replace":switch(_){case 2:return h.set(E,l);case 3:v(16);default:return h[E]=l}case t:switch(_){case 1:return E==="-"?h.push(l):h.splice(E,0,l);case 2:return h.set(E,l);case 3:return h.add(l);default:return h[E]=l}case"remove":switch(_){case 1:return h.splice(E,1);case 2:return h.delete(E);case 3:return h.delete(o.value);default:return delete h[E]}default:v(17,d)}}),s},N:function(s,i,o,r){switch(s.i){case 0:case 4:case 2:return function(d,h,a,u){var c=d.t,_=d.o;j(d.R,function(l,E){var y=Q(c,l),g=Q(_,l),B=E?$(c,l)?"replace":t:"remove";if(y!==g||B!=="replace"){var R=h.concat(l);a.push(B==="remove"?{op:B,path:R}:{op:B,path:R,value:g}),u.push(B===t?{op:"remove",path:R}:B==="remove"?{op:t,path:R,value:e(y)}:{op:"replace",path:R,value:e(y)})}})}(s,i,o,r);case 5:case 1:return function(d,h,a,u){var c=d.t,_=d.R,l=d.o;if(l.length<c.length){var E=[l,c];c=E[0],l=E[1];var y=[u,a];a=y[0],u=y[1]}for(var g=0;g<c.length;g++)if(_[g]&&l[g]!==c[g]){var B=h.concat([g]);a.push({op:"replace",path:B,value:e(l[g])}),u.push({op:"replace",path:B,value:e(c[g])})}for(var R=c.length;R<l.length;R++){var P=h.concat([R]);a.push({op:t,path:P,value:e(l[R])})}c.length<l.length&&u.push({op:"replace",path:h.concat(["length"]),value:c.length})}(s,i,o,r);case 3:return function(d,h,a,u){var c=d.t,_=d.o,l=0;c.forEach(function(E){if(!_.has(E)){var y=h.concat([l]);a.push({op:"remove",path:y,value:E}),u.unshift({op:t,path:y,value:E})}l++}),l=0,_.forEach(function(E){if(!c.has(E)){var y=h.concat([l]);a.push({op:t,path:y,value:E}),u.unshift({op:"remove",path:y,value:E})}l++})}(s,i,o,r)}},M:function(s,i,o,r){o.push({op:"replace",path:[],value:i===ge?void 0:i}),r.push({op:"replace",path:[],value:s})}})}var Ue,K,Ae=typeof Symbol<"u"&&typeof Symbol("x")=="symbol",wt=typeof Map<"u",Mt=typeof Set<"u",Ve=typeof Proxy<"u"&&Proxy.revocable!==void 0&&typeof Reflect<"u",ge=Ae?Symbol.for("immer-nothing"):((Ue={})["immer-nothing"]=!0,Ue),W=Ae?Symbol.for("immer-draftable"):"__$immer_draftable",C=Ae?Symbol.for("immer-state"):"__$immer_state",Lt=""+Object.prototype.constructor,Be=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:Object.getOwnPropertySymbols!==void 0?function(n){return Object.getOwnPropertyNames(n).concat(Object.getOwnPropertySymbols(n))}:Object.getOwnPropertyNames,xt=Object.getOwnPropertyDescriptors||function(n){var e={};return Be(n).forEach(function(t){e[t]=Object.getOwnPropertyDescriptor(n,t)}),e},_e={},Ee={get:function(n,e){if(e===C)return n;var t=x(n);if(!$(t,e))return function(i,o,r){var d,h=Pe(o,r);return h?"value"in h?h.value:(d=h.get)===null||d===void 0?void 0:d.call(i.k):void 0}(n,t,e);var s=t[e];return n.I||!M(s)?s:s===ue(n.t,e)?(ae(n),n.o[e]=fe(n.A.h,s,n)):s},has:function(n,e){return e in x(n)},ownKeys:function(n){return Reflect.ownKeys(x(n))},set:function(n,e,t){var s=Pe(x(n),e);if(s?.set)return s.set.call(n.k,t),!0;if(!n.P){var i=ue(x(n),e),o=i?.[C];if(o&&o.t===t)return n.o[e]=t,n.R[e]=!1,!0;if(Rt(t,i)&&(t!==void 0||$(n.t,e)))return!0;ae(n),le(n)}return n.o[e]===t&&(t!==void 0||e in n.o)||Number.isNaN(t)&&Number.isNaN(n.o[e])||(n.o[e]=t,n.R[e]=!0),!0},deleteProperty:function(n,e){return ue(n.t,e)!==void 0||e in n.t?(n.R[e]=!1,ae(n),le(n)):delete n.R[e],n.o&&delete n.o[e],!0},getOwnPropertyDescriptor:function(n,e){var t=x(n),s=Reflect.getOwnPropertyDescriptor(t,e);return s&&{writable:!0,configurable:n.i!==1||e!=="length",enumerable:s.enumerable,value:t[e]}},defineProperty:function(){v(11)},getPrototypeOf:function(n){return Object.getPrototypeOf(n.t)},setPrototypeOf:function(){v(12)}},Y={};j(Ee,function(n,e){Y[n]=function(){return arguments[0]=arguments[0][0],e.apply(this,arguments)}}),Y.deleteProperty=function(n,e){return Y.set.call(this,n,e,void 0)},Y.set=function(n,e,t){return Ee.set.call(this,n[0],e,t,n[0])};var bt=function(){function n(t){var s=this;this.O=Ve,this.D=!0,this.produce=function(i,o,r){if(typeof i=="function"&&typeof o!="function"){var d=o;o=i;var h=s;return function(y){var g=this;y===void 0&&(y=d);for(var B=arguments.length,R=Array(B>1?B-1:0),P=1;P<B;P++)R[P-1]=arguments[P];return h.produce(y,function(it){var Ie;return(Ie=o).call.apply(Ie,[g,it].concat(R))})}}var a;if(typeof o!="function"&&v(6),r!==void 0&&typeof r!="function"&&v(7),M(i)){var u=be(s),c=fe(s,i,void 0),_=!0;try{a=o(c),_=!1}finally{_?J(u):he(u)}return typeof Promise<"u"&&a instanceof Promise?a.then(function(y){return oe(u,r),re(y,u)},function(y){throw J(u),y}):(oe(u,r),re(a,u))}if(!i||typeof i!="object"){if((a=o(i))===void 0&&(a=i),a===ge&&(a=void 0),s.D&&ve(a,!0),r){var l=[],E=[];w("Patches").M(i,a,l,E),r(l,E)}return a}v(21,i)},this.produceWithPatches=function(i,o){if(typeof i=="function")return function(a){for(var u=arguments.length,c=Array(u>1?u-1:0),_=1;_<u;_++)c[_-1]=arguments[_];return s.produceWithPatches(a,function(l){return i.apply(void 0,[l].concat(c))})};var r,d,h=s.produce(i,o,function(a,u){r=a,d=u});return typeof Promise<"u"&&h instanceof Promise?h.then(function(a){return[a,r,d]}):[h,r,d]},typeof t?.useProxies=="boolean"&&this.setUseProxies(t.useProxies),typeof t?.autoFreeze=="boolean"&&this.setAutoFreeze(t.autoFreeze)}var e=n.prototype;return e.createDraft=function(t){M(t)||v(8),D(t)&&(t=Nt(t));var s=be(this),i=fe(this,t,void 0);return i[C].C=!0,he(s),i},e.finishDraft=function(t,s){var i=t&&t[C],o=i.A;return oe(o,s),re(void 0,o)},e.setAutoFreeze=function(t){this.D=t},e.setUseProxies=function(t){t&&!Ve&&v(20),this.O=t},e.applyPatches=function(t,s){var i;for(i=s.length-1;i>=0;i--){var o=s[i];if(o.path.length===0&&o.op==="replace"){t=o.value;break}}i>-1&&(s=s.slice(i+1));var r=w("Patches").$;return D(t)?r(t,s):this.produce(t,function(d){return r(d,s)})},n}(),S=new bt;S.produce;var Re=S.produceWithPatches.bind(S);S.setAutoFreeze.bind(S);S.setUseProxies.bind(S);S.applyPatches.bind(S);S.createDraft.bind(S);S.finishDraft.bind(S);var U=function(n,e,t,s){function i(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function d(u){try{a(s.next(u))}catch(c){r(c)}}function h(u){try{a(s.throw(u))}catch(c){r(c)}}function a(u){u.done?o(u.value):i(u.value).then(d,h)}a((s=s.apply(n,e||[])).next())})};Te();class Dt{constructor(e){this.messageBus=e}getItems(e){return U(this,void 0,void 0,function*(){if(Array.isArray(e)){const{items:t}=yield this.messageBus.sendAsync("OBR_SCENE_ITEMS_GET_ITEMS",{ids:e});return t}else if(e){const{items:t}=yield this.messageBus.sendAsync("OBR_SCENE_ITEMS_GET_ALL_ITEMS",{});return t.filter(e)}else{const{items:t}=yield this.messageBus.sendAsync("OBR_SCENE_ITEMS_GET_ALL_ITEMS",{});return t}})}isItemArray(e){return Array.isArray(e)&&e.every(t=>typeof t!="string")}updateItems(e,t,s=!0){return U(this,void 0,void 0,function*(){let i;this.isItemArray(e)?i=e:i=yield this.getItems(e);const[o,r]=Re(i,t),d=o.map(h=>({id:h.id,type:h.type}));for(const h of r){const[a,u]=h.path;typeof a=="number"&&typeof u=="string"&&(d[a][u]=o[a][u])}yield this.messageBus.sendAsync("OBR_SCENE_ITEMS_UPDATE_ITEMS",{updates:d,updateAttachments:s})})}addItems(e){return U(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_SCENE_ITEMS_ADD_ITEMS",{items:e})})}deleteItems(e){return U(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_SCENE_ITEMS_DELETE_ITEMS",{ids:e})})}getItemAttachments(e){return U(this,void 0,void 0,function*(){const{items:t}=yield this.messageBus.sendAsync("OBR_SCENE_ITEMS_GET_ITEM_ATTACHMENTS",{ids:e});return t})}getItemBounds(e){return U(this,void 0,void 0,function*(){const{bounds:t}=yield this.messageBus.sendAsync("OBR_SCENE_ITEMS_GET_ITEM_BOUNDS",{ids:e});return t})}onChange(e){const t=s=>{e(s.items)};return this.messageBus.send("OBR_SCENE_ITEMS_SUBSCRIBE",{}),this.messageBus.on("OBR_SCENE_ITEMS_EVENT_CHANGE",t),()=>{this.messageBus.send("OBR_SCENE_ITEMS_UNSUBSCRIBE",{}),this.messageBus.off("OBR_SCENE_ITEMS_EVENT_CHANGE",t)}}}var V=function(n,e,t,s){function i(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function d(u){try{a(s.next(u))}catch(c){r(c)}}function h(u){try{a(s.throw(u))}catch(c){r(c)}}function a(u){u.done?o(u.value):i(u.value).then(d,h)}a((s=s.apply(n,e||[])).next())})};Te();class Pt{constructor(e){this.messageBus=e}getItems(e){return V(this,void 0,void 0,function*(){if(Array.isArray(e)){const{items:t}=yield this.messageBus.sendAsync("OBR_SCENE_LOCAL_GET_ITEMS",{ids:e});return t}else if(e){const{items:t}=yield this.messageBus.sendAsync("OBR_SCENE_LOCAL_GET_ALL_ITEMS",{});return t.filter(e)}else{const{items:t}=yield this.messageBus.sendAsync("OBR_SCENE_LOCAL_GET_ALL_ITEMS",{});return t}})}updateItems(e,t,s,i=!0){return V(this,void 0,void 0,function*(){const o=yield this.getItems(e),[r,d]=Re(o,t),h=r.map(a=>({id:a.id,type:a.type}));for(const a of d){const[u,c]=a.path;typeof u=="number"&&typeof c=="string"&&(h[u][c]=r[u][c])}yield this.messageBus.sendAsync("OBR_SCENE_LOCAL_UPDATE_ITEMS",{updates:h,fastUpdate:s,updateAttachments:i})})}addItems(e){return V(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_SCENE_LOCAL_ADD_ITEMS",{items:e})})}deleteItems(e){return V(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_SCENE_LOCAL_DELETE_ITEMS",{ids:e})})}getItemAttachments(e){return V(this,void 0,void 0,function*(){const{items:t}=yield this.messageBus.sendAsync("OBR_SCENE_LOCAL_GET_ITEM_ATTACHMENTS",{ids:e});return t})}getItemBounds(e){return V(this,void 0,void 0,function*(){const{bounds:t}=yield this.messageBus.sendAsync("OBR_SCENE_LOCAL_GET_ITEM_BOUNDS",{ids:e});return t})}onChange(e){const t=s=>{e(s.items)};return this.messageBus.send("OBR_SCENE_LOCAL_SUBSCRIBE",{}),this.messageBus.on("OBR_SCENE_LOCAL_EVENT_CHANGE",t),()=>{this.messageBus.send("OBR_SCENE_LOCAL_UNSUBSCRIBE",{}),this.messageBus.off("OBR_SCENE_LOCAL_EVENT_CHANGE",t)}}}var ce=function(n,e,t,s){function i(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function d(u){try{a(s.next(u))}catch(c){r(c)}}function h(u){try{a(s.throw(u))}catch(c){r(c)}}function a(u){u.done?o(u.value):i(u.value).then(d,h)}a((s=s.apply(n,e||[])).next())})};class Gt{constructor(e){this.messageBus=e,this.grid=new gt(e),this.fog=new At(e),this.history=new Bt(e),this.items=new Dt(e),this.local=new Pt(e)}isReady(){return ce(this,void 0,void 0,function*(){const{ready:e}=yield this.messageBus.sendAsync("OBR_SCENE_IS_READY",{});return e})}onReadyChange(e){const t=s=>{e(s.ready)};return this.messageBus.send("OBR_SCENE_READY_SUBSCRIBE",{}),this.messageBus.on("OBR_SCENE_EVENT_READY_CHANGE",t),()=>{this.messageBus.send("OBR_SCENE_READY_UNSUBSCRIBE",{}),this.messageBus.off("OBR_SCENE_EVENT_READY_CHANGE",t)}}getMetadata(){return ce(this,void 0,void 0,function*(){const{metadata:e}=yield this.messageBus.sendAsync("OBR_SCENE_GET_METADATA",{});return e})}setMetadata(e){return ce(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_SCENE_SET_METADATA",{update:e})})}onMetadataChange(e){const t=s=>{e(s.metadata)};return this.messageBus.send("OBR_SCENE_METADATA_SUBSCRIBE",{}),this.messageBus.on("OBR_SCENE_METADATA_EVENT_CHANGE",t),()=>{this.messageBus.send("OBR_SCENE_METADATA_UNSUBSCRIBE",{}),this.messageBus.off("OBR_SCENE_METADATA_EVENT_CHANGE",t)}}}function tt(n){return n.startsWith("http")?n:`${window.location.origin}${n}`}function F(n){return n.map(e=>Object.assign(Object.assign({},e),{icon:tt(e.icon)}))}function Ce(n){return Object.assign(Object.assign({},n),{url:tt(n.url)})}var ke=function(n,e,t,s){function i(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function d(u){try{a(s.next(u))}catch(c){r(c)}}function h(u){try{a(s.throw(u))}catch(c){r(c)}}function a(u){u.done?o(u.value):i(u.value).then(d,h)}a((s=s.apply(n,e||[])).next())})};class Ut{constructor(e){this.contextMenus={},this.handleClick=t=>{var s;const i=this.contextMenus[t.id];i&&((s=i.onClick)===null||s===void 0||s.call(i,t.context,t.elementId))},this.messageBus=e,e.on("OBR_CONTEXT_MENU_EVENT_CLICK",this.handleClick)}create(e){return ke(this,void 0,void 0,function*(){this.messageBus.sendAsync("OBR_CONTEXT_MENU_CREATE",{id:e.id,shortcut:e.shortcut,icons:F(e.icons),embed:e.embed&&Ce(e.embed)}),this.contextMenus[e.id]=e})}remove(e){return ke(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_CONTEXT_MENU_REMOVE",{id:e}),delete this.contextMenus[e]})}}var N=function(n,e,t,s){function i(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function d(u){try{a(s.next(u))}catch(c){r(c)}}function h(u){try{a(s.throw(u))}catch(c){r(c)}}function a(u){u.done?o(u.value):i(u.value).then(d,h)}a((s=s.apply(n,e||[])).next())})};class Vt{constructor(e){this.tools={},this.toolActions={},this.toolModes={},this.handleToolClick=t=>{const s=this.tools[t.id];if(s)if(s.onClick){const i=s.onClick(t.context,t.elementId);Promise.resolve(i).then(o=>{o&&this.messageBus.send("OBR_TOOL_ACTIVATE",{id:t.id})})}else this.messageBus.send("OBR_TOOL_ACTIVATE",{id:t.id})},this.handleToolActionClick=t=>{var s;const i=this.toolActions[t.id];i&&((s=i.onClick)===null||s===void 0||s.call(i,t.context,t.elementId))},this.handleToolModeClick=t=>{const s=this.toolModes[t.id];if(s)if(s.onClick){const i=s.onClick(t.context,t.elementId);Promise.resolve(i).then(o=>{o&&this.messageBus.send("OBR_TOOL_MODE_ACTIVATE",{toolId:t.context.activeTool,modeId:t.id})})}else this.messageBus.send("OBR_TOOL_MODE_ACTIVATE",{toolId:t.context.activeTool,modeId:t.id})},this.handleToolModeToolClick=t=>{const s=this.toolModes[t.id];if(s)if(s.onToolClick){const i=s.onToolClick(t.context,t.event);Promise.resolve(i).then(o=>{o&&t.event.target&&!t.event.target.locked&&this.messageBus.sendAsync("OBR_PLAYER_SELECT",{items:[t.event.target.id]})})}else t.event.target&&!t.event.target.locked&&this.messageBus.sendAsync("OBR_PLAYER_SELECT",{items:[t.event.target.id]})},this.handleToolModeToolDoubleClick=t=>{const s=this.toolModes[t.id];if(s)if(s.onToolDoubleClick){const i=s.onToolDoubleClick(t.context,t.event);Promise.resolve(i).then(o=>{o&&t.event.target&&this.messageBus.sendAsync("OBR_PLAYER_SELECT",{items:[t.event.target.id]})})}else t.event.target&&this.messageBus.sendAsync("OBR_PLAYER_SELECT",{items:[t.event.target.id]})},this.handleToolModeToolDown=t=>{var s;const i=this.toolModes[t.id];i&&((s=i.onToolDown)===null||s===void 0||s.call(i,t.context,t.event))},this.handleToolModeToolMove=t=>{var s;const i=this.toolModes[t.id];i&&((s=i.onToolMove)===null||s===void 0||s.call(i,t.context,t.event))},this.handleToolModeToolUp=t=>{var s;const i=this.toolModes[t.id];i&&((s=i.onToolUp)===null||s===void 0||s.call(i,t.context,t.event))},this.handleToolModeToolDragStart=t=>{var s;const i=this.toolModes[t.id];i&&((s=i.onToolDragStart)===null||s===void 0||s.call(i,t.context,t.event))},this.handleToolModeToolDragMove=t=>{var s;const i=this.toolModes[t.id];i&&((s=i.onToolDragMove)===null||s===void 0||s.call(i,t.context,t.event))},this.handleToolModeToolDragEnd=t=>{var s;const i=this.toolModes[t.id];i&&((s=i.onToolDragEnd)===null||s===void 0||s.call(i,t.context,t.event))},this.handleToolModeToolDragCancel=t=>{var s;const i=this.toolModes[t.id];i&&((s=i.onToolDragCancel)===null||s===void 0||s.call(i,t.context,t.event))},this.handleToolModeKeyDown=t=>{var s;const i=this.toolModes[t.id];i&&((s=i.onKeyDown)===null||s===void 0||s.call(i,t.context,t.event))},this.handleToolModeKeyUp=t=>{var s;const i=this.toolModes[t.id];i&&((s=i.onKeyUp)===null||s===void 0||s.call(i,t.context,t.event))},this.handleToolModeActivate=t=>{var s;const i=this.toolModes[t.id];i&&((s=i.onActivate)===null||s===void 0||s.call(i,t.context))},this.handleToolModeDeactivate=t=>{var s;const i=this.toolModes[t.id];i&&((s=i.onDeactivate)===null||s===void 0||s.call(i,t.context))},this.messageBus=e,e.on("OBR_TOOL_EVENT_CLICK",this.handleToolClick),e.on("OBR_TOOL_ACTION_EVENT_CLICK",this.handleToolActionClick),e.on("OBR_TOOL_MODE_EVENT_CLICK",this.handleToolModeClick),e.on("OBR_TOOL_MODE_EVENT_TOOL_CLICK",this.handleToolModeToolClick),e.on("OBR_TOOL_MODE_EVENT_TOOL_DOUBLE_CLICK",this.handleToolModeToolDoubleClick),e.on("OBR_TOOL_MODE_EVENT_TOOL_DOWN",this.handleToolModeToolDown),e.on("OBR_TOOL_MODE_EVENT_TOOL_MOVE",this.handleToolModeToolMove),e.on("OBR_TOOL_MODE_EVENT_TOOL_UP",this.handleToolModeToolUp),e.on("OBR_TOOL_MODE_EVENT_TOOL_DRAG_START",this.handleToolModeToolDragStart),e.on("OBR_TOOL_MODE_EVENT_TOOL_DRAG_MOVE",this.handleToolModeToolDragMove),e.on("OBR_TOOL_MODE_EVENT_TOOL_DRAG_END",this.handleToolModeToolDragEnd),e.on("OBR_TOOL_MODE_EVENT_TOOL_DRAG_CANCEL",this.handleToolModeToolDragCancel),e.on("OBR_TOOL_MODE_EVENT_KEY_DOWN",this.handleToolModeKeyDown),e.on("OBR_TOOL_MODE_EVENT_KEY_UP",this.handleToolModeKeyUp),e.on("OBR_TOOL_MODE_EVENT_ACTIVATE",this.handleToolModeActivate),e.on("OBR_TOOL_MODE_EVENT_DEACTIVATE",this.handleToolModeDeactivate)}create(e){return N(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_TOOL_CREATE",{id:e.id,shortcut:e.shortcut,defaultMode:e.defaultMode,defaultMetadata:e.defaultMetadata,icons:F(e.icons),disabled:e.disabled}),this.tools[e.id]=e})}remove(e){return N(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_TOOL_REMOVE",{id:e}),delete this.tools[e]})}activateTool(e){return N(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_TOOL_ACTIVATE",{id:e})})}getMetadata(e){return N(this,void 0,void 0,function*(){const{metadata:t}=yield this.messageBus.sendAsync("OBR_TOOL_GET_METADATA",{id:e});return t})}setMetadata(e,t){return N(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_TOOL_SET_METADATA",{toolId:e,update:t})})}createAction(e){return N(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_TOOL_ACTION_CREATE",{id:e.id,shortcut:e.shortcut,icons:F(e.icons),disabled:e.disabled}),this.toolActions[e.id]=e})}removeAction(e){return N(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_TOOL_ACTION_REMOVE",{id:e}),delete this.tools[e]})}createMode(e){return N(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_TOOL_MODE_CREATE",{id:e.id,shortcut:e.shortcut,icons:F(e.icons),preventDrag:e.preventDrag,disabled:e.disabled,cursors:e.cursors}),this.toolModes[e.id]=e})}removeMode(e){return N(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_TOOL_MODE_REMOVE",{id:e}),delete this.tools[e]})}activateMode(e,t){return N(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_TOOL_MODE_ACTIVATE",{toolId:e,modeId:t})})}}var k=function(n,e,t,s){function i(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function d(u){try{a(s.next(u))}catch(c){r(c)}}function h(u){try{a(s.throw(u))}catch(c){r(c)}}function a(u){u.done?o(u.value):i(u.value).then(d,h)}a((s=s.apply(n,e||[])).next())})};class kt{constructor(e){this.messageBus=e}open(e){return k(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_POPOVER_OPEN",Object.assign({},Ce(e)))})}close(e){return k(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_POPOVER_CLOSE",{id:e})})}getWidth(e){return k(this,void 0,void 0,function*(){const{width:t}=yield this.messageBus.sendAsync("OBR_POPOVER_GET_WIDTH",{id:e});return t})}setWidth(e,t){return k(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_POPOVER_SET_WIDTH",{id:e,width:t})})}getHeight(e){return k(this,void 0,void 0,function*(){const{height:t}=yield this.messageBus.sendAsync("OBR_POPOVER_GET_HEIGHT",{id:e});return t})}setHeight(e,t){return k(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_POPOVER_SET_HEIGHT",{id:e,height:t})})}}var He=function(n,e,t,s){function i(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function d(u){try{a(s.next(u))}catch(c){r(c)}}function h(u){try{a(s.throw(u))}catch(c){r(c)}}function a(u){u.done?o(u.value):i(u.value).then(d,h)}a((s=s.apply(n,e||[])).next())})};class Ht{constructor(e){this.messageBus=e}open(e){return He(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_MODAL_OPEN",Object.assign({},Ce(e)))})}close(e){return He(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_MODAL_CLOSE",{id:e})})}}var A=function(n,e,t,s){function i(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function d(u){try{a(s.next(u))}catch(c){r(c)}}function h(u){try{a(s.throw(u))}catch(c){r(c)}}function a(u){u.done?o(u.value):i(u.value).then(d,h)}a((s=s.apply(n,e||[])).next())})};class jt{constructor(e){this.messageBus=e}getWidth(){return A(this,void 0,void 0,function*(){const{width:e}=yield this.messageBus.sendAsync("OBR_ACTION_GET_WIDTH",{});return e})}setWidth(e){return A(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_ACTION_SET_WIDTH",{width:e})})}getHeight(){return A(this,void 0,void 0,function*(){const{height:e}=yield this.messageBus.sendAsync("OBR_ACTION_GET_HEIGHT",{});return e})}setHeight(e){return A(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_ACTION_SET_HEIGHT",{height:e})})}getBadgeText(){return A(this,void 0,void 0,function*(){const{badgeText:e}=yield this.messageBus.sendAsync("OBR_ACTION_GET_BADGE_TEXT",{});return e})}setBadgeText(e){return A(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_ACTION_SET_BADGE_TEXT",{badgeText:e})})}getBadgeBackgroundColor(){return A(this,void 0,void 0,function*(){const{badgeBackgroundColor:e}=yield this.messageBus.sendAsync("OBR_ACTION_GET_BADGE_BACKGROUND_COLOR",{});return e})}setBadgeBackgroundColor(e){return A(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_ACTION_SET_BADGE_BACKGROUND_COLOR",{badgeBackgroundColor:e})})}getIcon(){return A(this,void 0,void 0,function*(){const{icon:e}=yield this.messageBus.sendAsync("OBR_ACTION_GET_ICON",{});return e})}setIcon(e){return A(this,void 0,void 0,function*(){const t=F([{icon:e}]);yield this.messageBus.sendAsync("OBR_ACTION_SET_ICON",{icon:t[0].icon})})}getTitle(){return A(this,void 0,void 0,function*(){const{title:e}=yield this.messageBus.sendAsync("OBR_ACTION_GET_TITLE",{});return e})}setTitle(e){return A(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_ACTION_SET_TITLE",{title:e})})}isOpen(){return A(this,void 0,void 0,function*(){const{isOpen:e}=yield this.messageBus.sendAsync("OBR_ACTION_GET_IS_OPEN",{});return e})}open(){return A(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_ACTION_OPEN",{})})}close(){return A(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_ACTION_CLOSE",{})})}onOpenChange(e){const t=s=>{e(s.isOpen)};return this.messageBus.send("OBR_ACTION_IS_OPEN_SUBSCRIBE",{}),this.messageBus.on("OBR_ACTION_IS_OPEN_EVENT_CHANGE",t),()=>{this.messageBus.send("OBR_IS_OPEN_ACTION_UNSUBSCRIBE",{}),this.messageBus.off("OBR_ACTION_IS_OPEN_EVENT_CHANGE",t)}}}var Yt=function(n,e,t,s){function i(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function d(u){try{a(s.next(u))}catch(c){r(c)}}function h(u){try{a(s.throw(u))}catch(c){r(c)}}function a(u){u.done?o(u.value):i(u.value).then(d,h)}a((s=s.apply(n,e||[])).next())})};Te();class Wt{constructor(e){this.messageBus=e}startItemInteraction(e,t=!0){return Yt(this,void 0,void 0,function*(){const{id:s}=yield this.messageBus.sendAsync("OBR_INTERACTION_START_ITEM_INTERACTION",{baseState:e,updateAttachments:t});let i=e;return[d=>{const[h,a]=Re(i,d);return i=h,this.messageBus.send("OBR_INTERACTION_UPDATE_ITEM_INTERACTION",{id:s,patches:a}),h},()=>{this.messageBus.send("OBR_INTERACTION_STOP_ITEM_INTERACTION",{id:s})}]})}}var Ft=function(n,e,t,s){function i(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function d(u){try{a(s.next(u))}catch(c){r(c)}}function h(u){try{a(s.throw(u))}catch(c){r(c)}}function a(u){u.done?o(u.value):i(u.value).then(d,h)}a((s=s.apply(n,e||[])).next())})};class $t{constructor(e){this.messageBus=e}getPlayers(){return Ft(this,void 0,void 0,function*(){const{players:e}=yield this.messageBus.sendAsync("OBR_PARTY_GET_PLAYERS",{});return e})}onChange(e){const t=s=>{e(s.players)};return this.messageBus.send("OBR_PARTY_SUBSCRIBE",{}),this.messageBus.on("OBR_PARTY_EVENT_CHANGE",t),()=>{this.messageBus.send("OBR_PARTY_UNSUBSCRIBE",{}),this.messageBus.off("OBR_PARTY_EVENT_CHANGE",t)}}}var de=function(n,e,t,s){function i(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function d(u){try{a(s.next(u))}catch(c){r(c)}}function h(u){try{a(s.throw(u))}catch(c){r(c)}}function a(u){u.done?o(u.value):i(u.value).then(d,h)}a((s=s.apply(n,e||[])).next())})};class Kt{constructor(e){this.messageBus=e}get id(){return this.messageBus.roomId}getPermissions(){return de(this,void 0,void 0,function*(){const{permissions:e}=yield this.messageBus.sendAsync("OBR_ROOM_GET_PERMISSIONS",{});return e})}getMetadata(){return de(this,void 0,void 0,function*(){const{metadata:e}=yield this.messageBus.sendAsync("OBR_ROOM_GET_METADATA",{});return e})}setMetadata(e){return de(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_ROOM_SET_METADATA",{update:e})})}onMetadataChange(e){const t=s=>{e(s.metadata)};return this.messageBus.send("OBR_ROOM_METADATA_SUBSCRIBE",{}),this.messageBus.on("OBR_ROOM_METADATA_EVENT_CHANGE",t),()=>{this.messageBus.send("OBR_METADATA_ROOM_UNSUBSCRIBE",{}),this.messageBus.off("OBR_ROOM_METADATA_EVENT_CHANGE",t)}}onPermissionsChange(e){const t=s=>{e(s.permissions)};return this.messageBus.send("OBR_ROOM_PERMISSIONS_SUBSCRIBE",{}),this.messageBus.on("OBR_ROOM_PERMISSIONS_EVENT_CHANGE",t),()=>{this.messageBus.send("OBR_PERMISSIONS_ROOM_UNSUBSCRIBE",{}),this.messageBus.off("OBR_ROOM_PERMISSIONS_EVENT_CHANGE",t)}}}var zt=function(n,e,t,s){function i(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function d(u){try{a(s.next(u))}catch(c){r(c)}}function h(u){try{a(s.throw(u))}catch(c){r(c)}}function a(u){u.done?o(u.value):i(u.value).then(d,h)}a((s=s.apply(n,e||[])).next())})};class Xt{constructor(e){this.messageBus=e}getTheme(){return zt(this,void 0,void 0,function*(){const{theme:e}=yield this.messageBus.sendAsync("OBR_THEME_GET_THEME",{});return e})}onChange(e){const t=s=>{e(s.theme)};return this.messageBus.send("OBR_THEME_SUBSCRIBE",{}),this.messageBus.on("OBR_THEME_EVENT_CHANGE",t),()=>{this.messageBus.send("OBR_THEME_UNSUBSCRIBE",{}),this.messageBus.off("OBR_THEME_EVENT_CHANGE",t)}}}var je=function(n,e,t,s){function i(o){return o instanceof t?o:new t(function(r){r(o)})}return new(t||(t=Promise))(function(o,r){function d(u){try{a(s.next(u))}catch(c){r(c)}}function h(u){try{a(s.throw(u))}catch(c){r(c)}}function a(u){u.done?o(u.value):i(u.value).then(d,h)}a((s=s.apply(n,e||[])).next())})};class Zt{constructor(e){this.messageBus=e}uploadImages(e){return je(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_ASSETS_UPLOAD_IMAGES",{images:e})})}uploadScenes(e){return je(this,void 0,void 0,function*(){yield this.messageBus.sendAsync("OBR_ASSETS_UPLOAD_SCENES",{scenes:e})})}}const qt=typeof atob=="function",Se=typeof Buffer=="function",Ye=typeof TextDecoder=="function"?new TextDecoder:void 0;typeof TextEncoder=="function"&&new TextEncoder;const Qt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",Jt=Array.prototype.slice.call(Qt),Z=(n=>{let e={};return n.forEach((t,s)=>e[t]=s),e})(Jt),en=/^(?:[A-Za-z\d+\/]{4})*?(?:[A-Za-z\d+\/]{2}(?:==)?|[A-Za-z\d+\/]{3}=?)?$/,b=String.fromCharCode.bind(String),We=typeof Uint8Array.from=="function"?Uint8Array.from.bind(Uint8Array):n=>new Uint8Array(Array.prototype.slice.call(n,0)),nt=n=>n.replace(/[^A-Za-z0-9\+\/]/g,""),tn=/[\xC0-\xDF][\x80-\xBF]|[\xE0-\xEF][\x80-\xBF]{2}|[\xF0-\xF7][\x80-\xBF]{3}/g,nn=n=>{switch(n.length){case 4:var e=(7&n.charCodeAt(0))<<18|(63&n.charCodeAt(1))<<12|(63&n.charCodeAt(2))<<6|63&n.charCodeAt(3),t=e-65536;return b((t>>>10)+55296)+b((t&1023)+56320);case 3:return b((15&n.charCodeAt(0))<<12|(63&n.charCodeAt(1))<<6|63&n.charCodeAt(2));default:return b((31&n.charCodeAt(0))<<6|63&n.charCodeAt(1))}},sn=n=>n.replace(tn,nn),on=n=>{if(n=n.replace(/\s+/g,""),!en.test(n))throw new TypeError("malformed base64.");n+="==".slice(2-(n.length&3));let e,t="",s,i;for(let o=0;o<n.length;)e=Z[n.charAt(o++)]<<18|Z[n.charAt(o++)]<<12|(s=Z[n.charAt(o++)])<<6|(i=Z[n.charAt(o++)]),t+=s===64?b(e>>16&255):i===64?b(e>>16&255,e>>8&255):b(e>>16&255,e>>8&255,e&255);return t},st=qt?n=>atob(nt(n)):Se?n=>Buffer.from(n,"base64").toString("binary"):on,rn=Se?n=>We(Buffer.from(n,"base64")):n=>We(st(n).split("").map(e=>e.charCodeAt(0))),un=Se?n=>Buffer.from(n,"base64").toString("utf8"):Ye?n=>Ye.decode(rn(n)):n=>sn(st(n)),an=n=>nt(n.replace(/[-_]/g,e=>e=="-"?"+":"/")),cn=n=>un(an(n));function dn(){const e=new URLSearchParams(window.location.search).get("obrref");let t="",s="";if(e){const o=cn(e).split(" ");o.length===2&&(t=o[0],s=o[1])}return{origin:t,roomId:s}}var Fe;(function(n){n[n.MOVE=0]="MOVE",n[n.LINE=1]="LINE",n[n.QUAD=2]="QUAD",n[n.CONIC=3]="CONIC",n[n.CUBIC=4]="CUBIC",n[n.CLOSE=5]="CLOSE"})(Fe||(Fe={}));const ye=dn(),p=new mt(ye.origin,ye.roomId),hn=new rt(p),ln=new ot(p),fn=new $t(p),_n=new Tt(p),En=new Gt(p),yn=new Ut(p),On=new Vt(p),pn=new kt(p),vn=new Ht(p),mn=new jt(p),Tn=new Wt(p),An=new Kt(p),gn=new Xt(p),Bn=new Zt(p),Rn={onReady:n=>{p.ready?n():p.once("OBR_READY",()=>n())},get isReady(){return p.ready},viewport:hn,player:ln,party:fn,notification:_n,scene:En,contextMenu:yn,tool:On,popover:pn,modal:vn,action:mn,interaction:Tn,room:An,theme:gn,assets:Bn,isAvailable:!!ye.origin};class Cn{static EXTENSIONID="com.battle-system.theatre";static MULTIPAGE=`What is Lorem Ipsum?
    Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged.
    ::
    Why do we use it?
    It is a long established fact that a reader will be distracted by the readable content of a page when looking at its layout. The point of using Lorem Ipsum is that it has a more-or-less normal distribution of letters, as opposed to using 'Content here, content here', making it look like readable English. Many desktop publishing packages and web page editors now use Lorem Ipsum as their default model text.
    ::
    Why are you doing this?
    Because I hate writing filler text.
    `;static FRESHPRINCE=`Now, this is a story all about how
    My life got flipped-turned upside down
    And I'd like to take a minute
    Just sit right there
    I'll tell you how I became the prince of a town called Bel-Air
    In West Philadelphia born and raised
    On the playground was where I spent most of my days
    Chillin' out, maxin', relaxin', all cool
    And all shootin' some b-ball outside of the school
    When a couple of guys who were up to no good
    Started making trouble in my neighborhood
    I got in one little fight and my mom got scared
    She said, "You're movin' with your auntie and uncle in Bel-Air"
    I begged and pleaded with her day after day
    But she packed my suitcase and sent me on my way
    She gave me a kiss and then she gave me my ticket
    I put my Walkman on and said, "I might as well kick it"
    First class, yo this is bad
    Drinking orange juice out of a champagne glass
    Is this what the people of Bel-Air living like?
    Hmm, this might be alright
    But wait, I hear they're prissy, bourgeois, all that
    Is this the type of place that they just send this cool cat?
    I don't think so
    I'll see when I get there
    I hope they're prepared for the prince of Bel-Air
    Well, the plane landed and when I came out
    There was a dude who looked like a cop standing there with my name out
    I ain't trying to get arrested yet, I just got here
    I sprang with the quickness like lightning, disappeared
    I whistled for a cab and when it came near
    The license plate said, "Fresh" and it had dice in the mirror
    If anything I could say that this cab was rare
    But I thought "Nah, forget it, yo, holmes to Bel Air"
    I pulled up to the house about seven or eight
    And I yelled to the cabbie, "Yo holmes, smell ya later"
    I looked at my kingdom
    I was finally there
    To sit on my throne as the prince of Bel-Air`}function Sn(){let n=new Date().getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const s=(n+Math.random()*16)%16|0;return n=Math.floor(n/16),(t==="x"?s:s&3|8).toString(16)})}function In(n,e){const t=window.matchMedia("(prefers-color-scheme: dark)"),s=t.matches?"dark":"light",i=t.matches?"light":"dark";for(var o=0;o<e.styleSheets.length;o++)for(var r=0;r<e.styleSheets[o].cssRules.length;r++){let d=e.styleSheets[o].cssRules[r];d&&d.media&&d.media.mediaText.includes("prefers-color-scheme")&&(n=="LIGHT"?(d.media.appendMedium(`(prefers-color-scheme: ${s})`),d.media.mediaText.includes(i)&&d.media.deleteMedium(`(prefers-color-scheme: ${i})`)):n=="DARK"&&(d.media.appendMedium(`(prefers-color-scheme: ${i})`),d.media.mediaText.includes(s)&&d.media.deleteMedium(`(prefers-color-scheme: ${s})`)))}}export{Cn as C,Sn as G,Rn as O,In as S};
