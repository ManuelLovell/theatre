import{O as t,B as a,T as g,C as o,L as i}from"./bsSceneCache-Cf7b9lp_.js";await t.onReady(async()=>{if(await t.scene.isReady()===!1){const e=t.scene.onReadyChange(async d=>{d&&(e(),await n())})}else await n()});async function n(){await a.InitializeCache(),await g.StartThreatre(),a.SetupHandlers(),a.OpenBroadcast(),await a.LoadDialogueCache(),t.broadcast.onMessage(o.EXTENSIONID+"/dialogue-request",async s=>{const e=s.data;e.type==="REQUEST_DIALOGUES"?(i.log("[Theatre] Storage modal requesting dialogues, sending",a.getDialogueCache().length,"dialogues"),await t.broadcast.sendMessage(o.EXTENSIONID+"/dialogue-response",{type:"DIALOGUES_DATA",dialogues:a.getDialogueCache(),registered:a.USER_REGISTERED},{destination:"LOCAL"})):e.type==="UPDATE_DIALOGUE"?(i.log("[Theatre] Updating dialogue in cache:",e.dialogue.id),a.updateDialogueInCache(e.dialogue)):e.type==="DELETE_DIALOGUE"&&(i.log("[Theatre] Deleting dialogue from cache:",e.id),a.deleteDialogueFromCache(e.id))})}
